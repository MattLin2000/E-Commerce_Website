<!DOCTYPE html>
<html lang="zh-TW">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>商品一覽</title>
    <!-- 引入 CSS 文件 -->
    <link rel="stylesheet" href="/css/bootstrap.min.css" />
    <link rel="stylesheet" href="/css/main.css" />
    <!-- 其他需要的 CSS 文件 -->
  </head>
  <body>
    <!-- Start Breadcrumbs -->
    <div class="breadcrumbs">
      <div class="container">
        <div class="row align-items-center">
          <div class="col-lg-6 col-md-6 col-12">
            <div class="breadcrumbs-content">
              <h1 class="page-title">商品一覽</h1>
            </div>
          </div>
          <div class="col-lg-6 col-md-6 col-12">
            <ul class="breadcrumb-nav">
              <li>
                <a href="index.html"><i class="lni lni-home"></i> 首頁</a>
              </li>
              <li><a href="javascript:void(0)">商城</a></li>
              <li>商品一覽</li>
            </ul>
          </div>
        </div>
      </div>
    </div>
    <!-- End Breadcrumbs -->

    <!-- Start Product Grids -->
    <section class="product-grids section">
      <div class="container">
        <h1 class="mb-4">商品列表</h1>
        <div class="row" id="product-list">
          <!-- 商品列表將由 JavaScript 動態插入 -->
        </div>
      </div>
    </section>
    <!-- End Product Grids -->

    <!-- Start Footer Area -->
    <footer class="footer">
      <!-- Start Footer Top -->
      <div class="footer-top">
        <div class="container">
          <div class="inner-content">
            <div class="row">
              <div class="col-lg-3 col-md-4 col-12">
                <div class="footer-logo">
                  <a href="index.html">
                    <img src="/images/logo/white-logo.svg" alt="Logo" />
                  </a>
                </div>
              </div>
              <div class="col-lg-9 col-md-8 col-12">
                <div class="footer-newsletter">
                  <h4 class="title">
                    訂閱最新消息<span>獲得我們商品特價的最新消息</span>
                  </h4>
                  <div class="newsletter-form-head">
                    <form action="#" method="get" class="newsletter-form">
                      <input
                        name="EMAIL"
                        placeholder="Email address here..."
                        type="email"
                      />
                      <div class="button">
                        <button class="btn">
                          訂閱<span class="dir-part"></span>
                        </button>
                      </div>
                    </form>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <!-- End Footer Top -->

      <!-- Start Footer Middle -->
      <div class="footer-middle">
        <div class="container">
          <div class="bottom-inner">
            <div class="row">
              <div class="col-lg-3 col-md-6 col-12">
                <div class="single-footer f-contact">
                  <h3>聯繫我們</h3>
                  <p class="phone">Phone: +886 91234567</p>
                  <ul>
                    <li><span>星期一至星期五:</span> 9.00 am - 8.00 pm</li>
                    <li><span>星期六、日:</span> 10.00 am - 6.00 pm</li>
                  </ul>
                  <p class="mail">
                    <a href="mailto:support@shopgrids.com"
                      >support@shopgrids.com</a
                    >
                  </p>
                </div>
              </div>
              <div class="col-lg-3 col-md-6 col-12">
                <div class="single-footer our-app">
                  <h3>下載我們的App</h3>
                  <ul class="app-btn">
                    <li>
                      <a href="javascript:void(0)">
                        <i class="lni lni-apple"></i>
                        <span class="small-title">下載連結</span>
                        <span class="big-title">App Store</span>
                      </a>
                    </li>
                    <li>
                      <a href="javascript:void(0)">
                        <i class="lni lni-play-store"></i>
                        <span class="small-title">下載連結</span>
                        <span class="big-title">Google Play</span>
                      </a>
                    </li>
                  </ul>
                </div>
              </div>
              <div class="col-lg-3 col-md-6 col-12">
                <div class="single-footer f-link">
                  <h3>資訊</h3>
                  <ul>
                    <li><a href="about-us.html">關於我們</a></li>
                    <li><a href="contact.html">聯繫我們</a></li>
                    <li><a href="javascript:void(0)">服務據點</a></li>
                    <li><a href="faq.html">常見問題</a></li>
                  </ul>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <!-- End Footer Middle -->

      <!-- Start Footer Bottom -->
      <div class="footer-bottom">
        <div class="container">
          <div class="inner-content">
            <div class="row align-items-center">
              <div class="col-lg-4 col-12">
                <div class="payment-gateway">
                  <span>可支援的支付:</span>
                  <img
                    src="/images/footer/credit-cards-footer.png"
                    alt="支付方式"
                  />
                </div>
              </div>
              <div class="col-lg-4 col-12">
                <ul class="socila">
                  <li><span>關注我們:</span></li>
                  <li>
                    <a href="javascript:void(0)"
                      ><i class="lni lni-facebook-filled"></i
                    ></a>
                  </li>
                  <li>
                    <a href="javascript:void(0)"
                      ><i class="lni lni-twitter-original"></i
                    ></a>
                  </li>
                  <li>
                    <a href="javascript:void(0)"
                      ><i class="lni lni-instagram"></i
                    ></a>
                  </li>
                  <li>
                    <a href="javascript:void(0)"
                      ><i class="lni lni-google"></i
                    ></a>
                  </li>
                </ul>
              </div>
            </div>
          </div>
        </div>
      </div>
      <!-- End Footer Bottom -->
    </footer>
    <!-- End Footer Area -->

    <!-- Scroll to Top Button -->
    <a href="#" class="scroll-top">
      <i class="lni lni-chevron-up"></i>
    </a>

    <!-- JS 文件 -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script>
      $(document).ready(function () {
        // 讀取商品列表
        function loadProducts() {
          $.ajax({
            url: "/api/products",
            method: "GET",
            success: function (data) {
              const productList = $("#product-list");
              productList.empty(); // 清空現有內容
              data.forEach((product) => {
                productList.append(`
                <div class="col-md-4">
                  <div class="card mb-4">
                    <img class="card-img-top" src="${product.image_url}" alt="${
                  product.name
                }">
                    <div class="card-body">
                      <h5 class="card-title">${product.name}</h5>
                      <p class="card-text">${product.description}</p>
                      <p class="card-text">$${product.price.toFixed(2)}</p>
                      <p class="card-text">庫存量: ${product.stock}</p>
                      <button class="btn btn-primary add-to-cart" data-product-id="${
                        product.product_id
                      }">加入購物車</button>
                    </div>
                  </div>
                </div>
                `);
              });

              // 綁定加入購物車按鈕事件
              $(".add-to-cart").click(function () {
                const productId = $(this).data("product-id");
                addToCart(productId);
              });
            },
            error: function (xhr, status, error) {
              console.error("Error loading products:", status, error);
            },
          });
        }

        // 將產品加入購物車
        function addToCart(productId) {
          $.ajax({
            url: "/api/cart/add",
            method: "POST",
            contentType: "application/json",
            data: JSON.stringify({ productId: productId, quantity: 1 }),
            success: function (response) {
              alert("產品已加入購物車！");
            },
            error: function (xhr, status, error) {
              console.error("Error adding product to cart:", status, error);
            },
          });
        }

        loadProducts();
      });
    </script>
  </body>
</html>
